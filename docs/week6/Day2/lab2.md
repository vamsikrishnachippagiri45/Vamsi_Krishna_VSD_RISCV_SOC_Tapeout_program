# Floorplanning and Placement


##  OpenLANE Configuration Hierarchy

OpenLANE uses a layered approach to configuration, where specific design settings override more general, default settings. This hierarchy ensures that every design step has the precise geometric and electrical parameters it needs.

1.  **OpenLANE Defaults (Base):**
    * Found in the main `$OPENLANE_ROOT/configuration` directory (e.g., `floorplan.tcl`, `config.tcl`). These files provide the foundational, generic settings for the entire flow.
2.  **Design Defaults (PDK-Specific):**
    * Found within the `$OPENLANE_ROOT/designs/<design_name>/` folder (e.g., `sky130_fd_sc_hd_config.tcl`).
    * These files override the base settings with values specifically tuned for the chosen **PDK** (e.g., `sky130A` and its standard cell library, `sky130_fd_sc_hd`).
3.  **User Configuration (Highest Priority):**
    * The primary file you modify to customize a specific design run (e.g., `config.tcl` inside the design folder).
    * **These settings override all others** and are used to fine-tune the design goals (speed vs. area) and physical parameters for the current project.


| Variable | Description | Default/Example Value | Design Impact |
| :--- | :--- | :--- | :--- |
| `FP_CORE_UTIL` | **Core Utilization Percentage.** The ratio of the total area of the standard cells (netlist) to the total available core area. | `50` (or `50%`) | Controls the **density** of the design. A lower number leaves more space for routing and is safer but wastes area. |
| `FP_ASPECT_RATIO` | The ratio of the core's height to its width ($\text{Height} / \text{Width}$). | `1` (for a square core) | Controls the **shape** of the core. Typically set to 1 for simplicity unless a specific chip shape is required. |
| `FP_IO_VLENGTH` | The vertical length of the I/O pins (in microns). | `4` | Controls the **size** of the pads on the chip edges. |
| `FP_IO_HLENGTH` | The horizontal length of the I/O pins (in microns). | `4` | Controls the **size** of the pads on the chip edges. |
| `FP_HORIZONTAL_HALO` | The margin (empty space) set between the core logic and the horizontal edges of the die. | N/A | Reserves space for Decap cells and power integrity structures. |
| `FP_PNR_AUTO_ADJUST` | Determines if the tool can automatically adjust the power grid spacing/size to fit the core area. | `1` (Enabled) | Allows the tool to automatically fill the core with power rings/straps. |

<img width="1920" height="923" alt="image" src="https://github.com/user-attachments/assets/fd8f9d1d-4470-4ecd-9be9-1a5fe2214d90" />

<img width="1920" height="923" alt="image" src="https://github.com/user-attachments/assets/74400b4d-7182-45b5-beaa-3d6963c976e6" />

<img width="1920" height="923" alt="image" src="https://github.com/user-attachments/assets/0a6f2f64-3929-4d42-90c0-bc3a9897b6c9" />




---


##  Floorplan Execution 

### 1\. OpenLANE Floorplan Execution

The following sequence of commands was used to launch the OpenLANE flow and execute the floorplan generation for the `picorv32a` design:

```bash
# Enter the OpenLANE flow container
docker 

# Enter interactive mode
./flow.tcl -interactive

# Load required packages
package require openlane 0.9

# Prepare the design files and directories
prep -design picorv32a

# Run Synthesis (a prerequisite step)
run_synthesis

# Execute the Floorplanning step
run_floorplan
```


<img width="1920" height="923" alt="image" src="https://github.com/user-attachments/assets/e88f8a60-2bc8-4580-bc85-96b3b461b266" />


<img width="1920" height="923" alt="image" src="https://github.com/user-attachments/assets/9519608f-1ed8-46a6-95b7-9c166d409df8" />


### 2\. Die Area Calculation from Floorplan DEF

The die dimensions were extracted from the `DIEAREA` coordinates within the Floorplan DEF file generated by the run.

  * **Conversion Rule:** $1000$ Unit Distance $= 1$ Micron ($\mu\text{m}$)
  * **DEF Coordinates:** `DIEAREA (0 0) (660685 671405)`

| Parameter | Value in Unit Distance | Value in Microns ($\mu\text{m}$) |
| :--- | :--- | :--- |
| **Die Width** | $660685 - 0 = 660685$ | $660685 / 1000 = \mathbf{660.685}$ |
| **Die Height** | $671405 - 0 = 671405$ | $671405 / 1000 = \mathbf{671.405}$ |

The total **Area of the Die** is calculated as:

$$\text{Area} = \text{Die Width} \times \text{Die Height}$$

$$\text{Area} = 660.685 \mu\text{m} \times 671.405 \mu\text{m} \approx \mathbf{443,587.21} \mu\text{m}^2$$



<img width="1920" height="923" alt="image" src="https://github.com/user-attachments/assets/545a7026-35d8-44c2-9ce4-08c11f55be97" />



### 3\. Magic Visualization of Floorplan

The generated floorplan DEF file was loaded into the **Magic VLSI Layout Tool** for visual inspection:

```bash
# Command executed in a separate terminal:
magic -T /home/vsduser/Desktop/work/tools/openlane_working_dir/pdks/sky130A/libs.tech/magic/sky130A.tech lef read ../../tmp/merged.lef def read picorv32a.floorplan.def &
```

The Magic tool confirmed the geometry, showing the outer **Die** boundary, the inner **Core** area, and the structured **placement rows** generated for the standard cells.

<img width="1920" height="923" alt="image" src="https://github.com/user-attachments/assets/2da6a400-231f-465b-94fa-c47a522a2779" />


---


This is the submission summary for the **Placement** stage of the `picorv32a` design, detailing the command execution, analysis of the key metrics from the log, and visual verification.

-----

## Placement Execution 

### 1\. Placement Execution

The placement step was executed after Floorplanning and Power Planning to physically arrange the synthesized logic cells onto the core area. The tool used is typically **RePlAce** within the OpenROAD application, which is congestion-aware by default.

```bash
# Command to run placement (congestion aware by default)
run_placement
```

<img width="1280" height="768" alt="image" src="https://github.com/user-attachments/assets/669e74a2-0eab-4f00-b7e7-1b1eba4c2a0a" />


### 2\. Placement Analysis Summary

The placement step successfully placed all instances, as detailed in the log output:

| Metric | Value | Interpretation |
| :--- | :--- | :--- |
| **Fixed Instances** | $6,354$ | Represents I/O pins, Decaps, and pre-placed macros that cannot be moved. |
| **Nets** | $15,449$ | The number of electrical connections between the cells that must be routed. |
| **Design Area** | $420,473.3 \mu\text{m}^2$ | The total area of the die used for this design. |
| **Utilization** | $\mathbf{55\%}$ | The ratio of total cell area to total core area. This leaves $45\%$ space for routing and filler cells. |
| **Rows** | $238$ | The number of horizontal rows available for placing standard cells in the core. |
| **Row Height** | $2.7 \text{ u}$ | The standard height of the cell rows in the PDK. |
| **HPWL Delta** | $\mathbf{-1.7\%}$ | The change in **Half-Perimeter Wire Length (HPWL)** after placement optimization. A negative change (from original to legal/optimized HPWL) indicates **improvement** in wire length estimation, which is good for timing and power. |

### 3\. Magic Placement Visualization

The resulting placement DEF file (`picorv32a.placement.def`) was loaded into the **Magic VLSI Layout Tool** for visual inspection of the core layout.

```bash
# Change directory to path containing generated placement def
cd Desktop/work/tools/openlane_working_dir/openlane/designs/picorv32a/runs/30-10_16-48/results/placement/

# Command to load the placement def in magic tool
magic -T /home/vsduser/Desktop/work/tools/openlane_working_dir/pdks/sky130A/libs.tech/magic/sky130A.tech lef read ../../tmp/merged.lef def read picorv32a.placement.def &
```

The visualization confirms that the standard cells (the dense black and colored shapes) have been arranged onto the horizontal placement rows within the core boundary. The **$55\%$ utilization** results in a fairly dense core, demonstrating the successful physical translation of the logical netlist.


<img width="1280" height="768" alt="image" src="https://github.com/user-attachments/assets/1ea24d22-77f4-4242-a043-d0789c9d5f41" />

---
